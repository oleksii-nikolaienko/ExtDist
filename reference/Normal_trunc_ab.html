<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>The truncated normal distribution. — Normal_trunc_ab • ExtDist</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="The truncated normal distribution. — Normal_trunc_ab" />
<meta property="og:description" content="Density, distribution, quantile, random number 
generation and parameter estimation functions for the truncated normal distribution with parameters mean, sd and 
a and b which represent the lower and upper truncation points respectively. 
Parameter estimation can be based on a weighted or unweighted i.i.d. sample and is performed numerically." />






<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



<!-- dependencies from examples -->


  

  

  </head>

  <body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ExtDist</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.6-5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/Distributions-Beta.html">Beta distribution</a>
    </li>
    <li>
      <a href="../articles/Distributions-Normal.html">Normal distribution</a>
    </li>
    <li>
      <a href="../articles/Distributions.html">Distributions included in the ExtDist package</a>
    </li>
    <li>
      <a href="../articles/ParaEst-and-DistSel-by-ExtDist.html">Parameter estimation and distribution selection by ExtDist</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>The truncated normal distribution.</h1>
    
    <div class="hidden name"><code>Normal_trunc_ab.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Density, distribution, quantile, random number 
generation and parameter estimation functions for the truncated normal distribution with parameters <code>mean</code>, <code>sd</code> and 
<code>a</code> and <code>b</code> which represent the lower and upper truncation points respectively. 
Parameter estimation can be based on a weighted or unweighted i.i.d. sample and is performed numerically.</p>
    </div>

    <pre class="usage"><span class='fu'>dNormal_trunc_ab</span><span class='op'>(</span>
  <span class='va'>x</span>,
  mu <span class='op'>=</span> <span class='fl'>0</span>,
  sigma <span class='op'>=</span> <span class='fl'>1</span>,
  a <span class='op'>=</span> <span class='fl'>0</span>,
  b <span class='op'>=</span> <span class='fl'>1</span>,
  params <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>mu</span>, <span class='va'>sigma</span>, <span class='va'>a</span>, <span class='va'>b</span><span class='op'>)</span>,
  <span class='va'>...</span>
<span class='op'>)</span>

<span class='fu'>pNormal_trunc_ab</span><span class='op'>(</span>
  <span class='va'>q</span>,
  mu <span class='op'>=</span> <span class='fl'>0</span>,
  sigma <span class='op'>=</span> <span class='fl'>1</span>,
  a <span class='op'>=</span> <span class='fl'>0</span>,
  b <span class='op'>=</span> <span class='fl'>1</span>,
  params <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>mu <span class='op'>=</span> <span class='fl'>2</span>, sigma <span class='op'>=</span> <span class='fl'>5</span>, a <span class='op'>=</span> <span class='fl'>0</span>, b <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>,
  <span class='va'>...</span>
<span class='op'>)</span>

<span class='fu'>qNormal_trunc_ab</span><span class='op'>(</span>
  <span class='va'>p</span>,
  mu <span class='op'>=</span> <span class='fl'>0</span>,
  sigma <span class='op'>=</span> <span class='fl'>1</span>,
  a <span class='op'>=</span> <span class='fl'>0</span>,
  b <span class='op'>=</span> <span class='fl'>1</span>,
  params <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>mu <span class='op'>=</span> <span class='fl'>2</span>, sigma <span class='op'>=</span> <span class='fl'>5</span>, a <span class='op'>=</span> <span class='fl'>0</span>, b <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>,
  <span class='va'>...</span>
<span class='op'>)</span>

<span class='fu'>rNormal_trunc_ab</span><span class='op'>(</span>
  <span class='va'>n</span>,
  mu <span class='op'>=</span> <span class='fl'>0</span>,
  sigma <span class='op'>=</span> <span class='fl'>1</span>,
  a <span class='op'>=</span> <span class='fl'>0</span>,
  b <span class='op'>=</span> <span class='fl'>1</span>,
  params <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>mu</span>, <span class='va'>sigma</span>, <span class='va'>a</span>, <span class='va'>b</span><span class='op'>)</span>,
  <span class='va'>...</span>
<span class='op'>)</span>

<span class='fu'>eNormal_trunc_ab</span><span class='op'>(</span><span class='va'>X</span>, <span class='va'>w</span>, method <span class='op'>=</span> <span class='st'>"numerical.MLE"</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='fu'>lNormal_trunc_ab</span><span class='op'>(</span>
  <span class='va'>X</span>,
  <span class='va'>w</span>,
  mu <span class='op'>=</span> <span class='fl'>0</span>,
  sigma <span class='op'>=</span> <span class='fl'>1</span>,
  a <span class='op'>=</span> <span class='fl'>0</span>,
  b <span class='op'>=</span> <span class='fl'>1</span>,
  params <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>mu</span>, <span class='va'>sigma</span>, <span class='va'>a</span>, <span class='va'>b</span><span class='op'>)</span>,
  logL <span class='op'>=</span> <span class='cn'>TRUE</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x, q</th>
      <td><p>A vector of quantiles.</p></td>
    </tr>
    <tr>
      <th>mu, sigma</th>
      <td><p>Shape parameters.</p></td>
    </tr>
    <tr>
      <th>a, b</th>
      <td><p>Boundary parameters.</p></td>
    </tr>
    <tr>
      <th>params</th>
      <td><p>A list that includes all named parameters.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Additional parameters.</p></td>
    </tr>
    <tr>
      <th>p</th>
      <td><p>A vector of probabilities.</p></td>
    </tr>
    <tr>
      <th>n</th>
      <td><p>Number of observations.</p></td>
    </tr>
    <tr>
      <th>X</th>
      <td><p>Sample observations.</p></td>
    </tr>
    <tr>
      <th>w</th>
      <td><p>An optional vector of sample weights.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>Parameter estimation method.</p></td>
    </tr>
    <tr>
      <th>logL</th>
      <td><p>logical;if TRUE, lNormal_trunc_ab gives the log-likelihood, otherwise the likelihood is given.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>dNormal_trunc_ab gives the density, pNormal_trunc_ab the distribution function,
qNormal_trunc_ab the quantile function, rNormal_trunc_ab generates random variables, and 
eNormal_trunc_ab estimates the parameters. lNormal_trunc_ab provides the log-likelihood function.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>If the <code>mean</code>, <code>sd</code>, <code>a</code> or <code>b</code> are not specified they assume the default values of 0, 1, 0, 1 respectively.<br />
<br />
The <code>dNormal_trunc_ab()</code>, <code>pNormal_trunc_ab()</code>, <code>qNormal_trunc_ab()</code>,and <code>rNormal_trunc_ab()</code> functions serve
 as wrappers of the <code><a href='https://rdrr.io/pkg/truncdist/man/dtrunc.html'>dtrunc</a></code>, <code><a href='https://rdrr.io/pkg/truncdist/man/ptrunc.html'>ptrunc</a></code>, <code><a href='https://rdrr.io/pkg/truncdist/man/qtrunc.html'>qtrunc</a></code>, and
<code><a href='https://rdrr.io/pkg/truncdist/man/rtrunc.html'>rtrunc</a></code> functions in the <span class="pkg">truncdist</span> package. They allow for the parameters to be declared not only as 
individual numerical values, but also as a list so parameter estimation can be carried out. <br />
<br />
The probability density function of the doubly truncated normal distribution is given by 
$$f(x) = \sigma^{-1} Z(x-\mu/\sigma)[\Phi(b-\mu/\sigma) - \Phi(a-\mu/\sigma)]^{-1}$$
where \(\infty &lt;a \le x \le b &lt; \infty\). The degrees of truncation are \(\Phi((a-\mu)/\sigma)\) from below and \(1-\Phi((a-\mu)/\sigma)\)
from above. If a is replaced by \(-\infty\), or b by \(\infty\), the distribution is singly truncated, (Johnson et.al, p.156).
The upper and lower limits of truncation \(a\) and \(b\) are normally known
parameters whereas \(\mu\) and \(\sigma\) may be unknown. Crain (1979) discusses parameter estimation for the truncated normal 
distribution and the method of numerical maximum likelihood estimation is used for parameter estimation in <code>eNormal_trunc_ab</code>.<br /> 
<br /></p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Johnson, N. L., Kotz, S. and Balakrishnan, N. (1994) Continuous Univariate Distributions,
 volume 1, chapter 13, Wiley, New York.<br />
<br />
Crain, B.R (1979). Estimating the parameters of a truncated normal distribution, Applied Mathematics and Computation,
vol 4, pp. 149-156</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><span class="pkg"><a href='ExtDist-package.html'>ExtDist</a></span> for other standard distributions.</p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Haizhen Wu and A. Jonathan R. Godfrey.<br />
Updates and bug fixes by Sarah Pirikahu.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Parameter estimation for a distribution with known shape parameters</span>
<span class='va'>X</span> <span class='op'>&lt;-</span> <span class='fu'>rNormal_trunc_ab</span><span class='op'>(</span>n<span class='op'>=</span> <span class='fl'>500</span>, mu<span class='op'>=</span> <span class='fl'>2</span>, sigma <span class='op'>=</span> <span class='fl'>5</span>, a <span class='op'>=</span> <span class='fl'>1</span>, b <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>
<span class='va'>est.par</span> <span class='op'>&lt;-</span> <span class='fu'>eNormal_trunc_ab</span><span class='op'>(</span><span class='va'>X</span><span class='op'>)</span>; <span class='va'>est.par</span>
</div><div class='output co'>#&gt; 
#&gt; Parameters for the Normal_trunc_ab distribution. 
#&gt; (found using the  numerical.MLE method.)
#&gt; 
#&gt;  Parameter     Type Estimate
#&gt;         mu    shape 1.646480
#&gt;      sigma    shape 0.980794
#&gt;          a boundary 1.000801
#&gt;          b boundary 1.998243
#&gt; 
#&gt; </div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>est.par</span><span class='op'>)</span>
</div><div class='img'><img src='Normal_trunc_ab-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>#  Fitted density curve and histogram</span>
<span class='va'>den.x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='op'>(</span><span class='va'>X</span><span class='op'>)</span>,<span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>X</span><span class='op'>)</span>,length<span class='op'>=</span><span class='fl'>100</span><span class='op'>)</span>
<span class='va'>den.y</span> <span class='op'>&lt;-</span> <span class='fu'>dNormal_trunc_ab</span><span class='op'>(</span><span class='va'>den.x</span>,params <span class='op'>=</span> <span class='va'>est.par</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/hist.html'>hist</a></span><span class='op'>(</span><span class='va'>X</span>, breaks<span class='op'>=</span><span class='fl'>10</span>, probability<span class='op'>=</span><span class='cn'>TRUE</span>, ylim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>1.2</span><span class='op'>*</span><span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>den.y</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span><span class='op'>(</span><span class='va'>den.x</span>, <span class='va'>den.y</span>, col<span class='op'>=</span><span class='st'>"blue"</span><span class='op'>)</span>
</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/density.html'>density</a></span><span class='op'>(</span><span class='va'>X</span><span class='op'>)</span>, lty <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>
</div><div class='img'><img src='Normal_trunc_ab-2.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># Extracting boundary and shape parameters</span>
<span class='va'>est.par</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/attributes.html'>attributes</a></span><span class='op'>(</span><span class='va'>est.par</span><span class='op'>)</span><span class='op'>$</span><span class='va'>par.type</span><span class='op'>==</span><span class='st'>"boundary"</span><span class='op'>]</span>
</div><div class='output co'>#&gt; $a
#&gt; [1] 1.000801
#&gt; 
#&gt; $b
#&gt; [1] 1.998243
#&gt; </div><div class='input'><span class='va'>est.par</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/attributes.html'>attributes</a></span><span class='op'>(</span><span class='va'>est.par</span><span class='op'>)</span><span class='op'>$</span><span class='va'>par.type</span><span class='op'>==</span><span class='st'>"shape"</span><span class='op'>]</span>
</div><div class='output co'>#&gt; $mu
#&gt; [1] 1.64648
#&gt; 
#&gt; $sigma
#&gt; [1] 0.980794
#&gt; </div><div class='input'>
<span class='co'># log-likelihood function</span>
<span class='fu'>lNormal_trunc_ab</span><span class='op'>(</span><span class='va'>X</span>,param <span class='op'>=</span> <span class='va'>est.par</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] 2.096838</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p><p>Developed by Oleksii Nikolaienko.</p></p>
</div>

<div class="pkgdown">
  <p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 1.6.1.9001.</p></p>
</div>

      </footer>
   </div>

  


  

  </body>
</html>


